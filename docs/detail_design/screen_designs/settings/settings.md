# 設定画面

## 画面概要
システム全体の設定を管理するための画面。ユーザー設定、組織設定、API連携、通知設定などを一元管理します。

## 画面レイアウト
```
+--------------------------------------------------+
|                    ヘッダー                        |
| 設定                                              |
+--------------------------------------------------+
|                                                  |
|  [設定を検索...]                                 |
|                                                  |
+--------------------------------------------------+
|                                                  |
|  サイドバー          メイン設定エリア              |
| +----------+  +--------------------------------+ |
| | 基本設定  |  | ユーザー設定                   | |
| |          |  | ユーザープロフィルと基本設定      | |
| | ユーザー  |  +--------------------------------+ |
| | 組織     |  | プロフィール                    | |
| | 通知     |  | +------------------------------+ |
| | API連携  |  | | アバター                     | |
| | セキュリ  |  | | [アップロード]               | |
| | ティ     |  | |                             | |
| |          |  | | 名前: 佐藤 太郎              | |
| | 詳細設定  |  | | メール: sato@example.com    | |
| |          |  | | 役割: 管理者                 | |
| |          |  | +------------------------------+ |
| |          |  |                                | |
| |          |  | 言語・地域設定                  | |
| |          |  | +------------------------------+ |
| |          |  | | 言語: 日本語                 | |
| |          |  | | タイムゾーン: Asia/Tokyo     | |
| |          |  | | 日付形式: YYYY/MM/DD        | |
| |          |  | +------------------------------+ |
| |          |  |                                | |
| |          |  | テーマ設定                     | |
| |          |  | +------------------------------+ |
| |          |  | | [○] ライトモード             | |
| |          |  | | [●] ダークモード             | |
| |          |  | | [ ] システム設定に従う        | |
| |          |  | +------------------------------+ |
| +----------+  |                                | |
|              | [変更を保存]                    | |
|              +--------------------------------+ |
+--------------------------------------------------+
```

## 設定カテゴリー

### 1. ユーザー設定
- **プロフィール設定**:
  - アバター画像
  - 名前
  - メールアドレス
  - 役割/権限
  - 所属部署

- **表示設定**:
  - 言語選択
  - タイムゾーン
  - 日付形式
  - 数値形式
  - テーマ設定

### 2. 組織設定
- **基本情報**:
  - 組織名
  - ロゴ
  - 業種
  - 従業員数
  - 事業所情報

- **メンバー管理**:
  - ユーザー一覧
  - 権限グループ
  - 招待管理
  - アクセス制御

### 3. 通知設定
- **メール通知**:
  - バッチジョブ完了通知
  - エラー通知
  - レポート通知
  - メンション通知

- **アプリ内通知**:
  - 重要アラート
  - タスク更新
  - コメント
  - システム通知

### 4. API連携
- **API設定**:
  - APIキー管理
  - Webhook設定
  - 連携サービス管理
  - 使用状況モニタリング

### 5. セキュリティ設定
- **認証設定**:
  - 2要素認証
  - シングルサインオン
  - パスワードポリシー
  - セッション管理

- **アクセス制御**:
  - IPアドレス制限
  - デバイス管理
  - 監査ログ
  - セキュリティアラート

## データモデル

### ユーザー設定
```typescript
interface UserSettings {
  profile: {
    avatar_url: string;
    name: string;
    email: string;
    role: 'admin' | 'manager' | 'user';
    department: string;
  };
  display: {
    language: string;
    timezone: string;
    date_format: string;
    number_format: string;
    theme: 'light' | 'dark' | 'system';
  };
  notifications: {
    email: {
      batch_job: boolean;
      error: boolean;
      report: boolean;
      mention: boolean;
    };
    in_app: {
      alerts: boolean;
      tasks: boolean;
      comments: boolean;
      system: boolean;
    };
  };
}
```

### 組織設定
```typescript
interface OrganizationSettings {
  basic: {
    name: string;
    logo_url: string;
    industry: string;
    size: number;
    locations: Location[];
  };
  security: {
    password_policy: PasswordPolicy;
    mfa_required: boolean;
    session_timeout: number;
    ip_whitelist: string[];
  };
  api: {
    keys: APIKey[];
    webhooks: Webhook[];
    rate_limits: RateLimit;
  };
}
```

## バリデーション

### プロフィール設定
- 名前: 必須、最大50文字
- メール: 有効なメールアドレス形式
- アバター: 最大2MB、jpg/png形式
- パスワード: 8文字以上、英数字記号混在

### 組織設定
- 組織名: 必須、最大100文字
- ��ゴ: 最大5MB、jpg/png形式
- APIキー: 自動生成、表示制限
- Webhook URL: 有効なURL形式

## エラーハンドリング

### 設定保存エラー
- 変更のバックアップ
- 自動リトライ
- エラー詳細の表示
- 復元オプション

### 検証エラー
- インラインバリデーション
- エラーメッセージ表示
- 修正ガイダンス
- 入力補助

## データ管理

### 1. 設定の永続化
- ローカルストレージ
- サーバー同期
- 変更履歴
- 設定のエクスポート/インポート

### 2. 権限管理
- 設定項目ごとの権限
- 変更の承認フロー
- 監査ログ
- 変更通知

## レスポンシブ対応

### デスクトップ
- サイドバー固定
- 設定項目の階層表示
- キーボードナビゲーション
- ツールチップガイド

### タブレット
- コラプシブルサイドバー
- タッチ操作最適化
- スクロール位置記憶
- 簡略化されたレイアウト

### モバイル
- ドロワーメニュー
- 設定の段階的表示
- タップターゲットの最適化
- 基本設定の優先表示 