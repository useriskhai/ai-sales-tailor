# CSVインポートダイアログ

## 画面概要
CSVファイルを使用して企業情報を一括インポートするための画面。ユーザーフレンドリーなインターフェースとガイダンス、プレビュー機能を提供し、エラーの事前検出と修正をサポートします。

## 画面レイアウト
```
+--------------------------------------------------+
|                                                  |
| CSVインポート                          [×] 閉じる |
+--------------------------------------------------+
|                                                  |
| ステップ 1/3: ファイルの選択と確認                 |
| [1]----------[2]----------[3]                    |
| ファイル選択   データ確認    完了                  |
|                                                  |
| +----------------------------------------------+ |
| |                                              | |
| |    ファイルをドラッグ＆ドロップ                | |
| |          または                              | |
| |    [ファイルを選択] ボタンをクリック           | |
| |                                              | |
| +----------------------------------------------+ |
|                                                  |
| 📥 テンプレートファイルをダウンロード              |
| ℹ️ 対応フォーマット: CSV, Excel (xlsx, xls)      |
|                                                  |
| --- プレビューとヘルプ ---                       |
| +----------------------------------------------+ |
| | 必須項目:                                     | |
| | ・企業名                                     | |
| | ・業種                                       | |
| | ・Webサイト                                  | |
| |                                              | |
| | 推奨項目:                                    | |
| | ・メールアドレス                              | |
| | ・電話番号                                    | |
| | ・所在地                                     | |
| +----------------------------------------------+ |
|                                                  |
| [戻る]                        [キャンセル] [次へ] |
+--------------------------------------------------+

--- ファイル選択後の画面 ---

+--------------------------------------------------+
| ステップ 2/3: データ確認とマ��ピング               |
|                                                  |
| ファイル: companies_import.csv                   |
| 検出された行数: 150件                            |
|                                                  |
| カラムのマッピング                               |
| +----------------------------------------------+ |
| | CSVの列         | 項目           | サンプル   | |
| |----------------|----------------|------------| |
| | Company Name   | 企業名 *       | AstraZeneca| |
| | Industry      | 業種 *         | 製薬       | |
| | Website       | Webサイト *    | www.astr...| |
| | Email         | メールアドレス  | info@...   | |
| +----------------------------------------------+ |
|                                                  |
| データプレビュー                                 |
| +----------------------------------------------+ |
| | 行 | ステータス | エラー内容                  | |
| |----|-----------|-----------------------------|
| | 1  | ✓ OK     |                            | |
| | 2  | ⚠️ 要確認  | メールアドレスの形式が不正   | |
| | 3  | ✓ OK     |                            | |
| +----------------------------------------------+ |
|                                                  |
| 検証結果                                        |
| ✓ 正常データ: 142件                             |
| ⚠️ 要確認: 6件                                  |
| ❌ エラー: 2件                                   |
|                                                  |
| [データを修正] [エラーをダウンロード]             |
|                                                  |
| [戻る]                        [キャンセル] [次へ] |
+--------------------------------------------------+

--- インポート実行画面 ---

+--------------------------------------------------+
| ステップ 3/3: インポート実行                      |
|                                                  |
| インポート準備完了                               |
| 合計: 150件                                     |
| ✓ 正常データ: 142件                             |
| ⚠️ 要確認: 6件（スキップして続行可能）            |
| ❌ エラー: 2件（修正が必要）                      |
|                                                  |
| オプション                                       |
| [✓] 重複データを更新する                         |
| [✓] インポート結果をメールで通知                  |
| [ ] エラーデータをスキップしてインポート           |
|                                                  |
| [インポートを実行]                               |
|                                                  |
| [戻る]                        [キャンセル] [完了] |
+--------------------------------------------------+
```

## インタラクティブ要素

### 1. ファイル選択エリア
- **ドラッグ＆ドロップ**:
  - ファイルドロップで自動アップロード
  - 複数ファイル対応
  - ファイル形式の自動検証

- **ファイル選択ボタン**:
  - クリックでファイル選択ダイアログ
  - 対応形式のフィルター
  - ファイルサイズの自動チェック

### 2. データマッピング
- **自動マッピング**:
  - ヘッダー行の自動認識
  - 類似項目の提案
  - カスタムマッピングの保存

- **マッピング編集**:
  - ドラッグ＆ドロップで列の並び替え
  - 必須項目の視覚的表示
  - データ型の自動検出と変換

### 3. データプレビュー
- **インライン編集**:
  - セルの直接編集
  - 一括修正機能
  - 変更履歴の表示

- **エラーハイライト**:
  - エラー行の強調表示
  - エラー内容のツールチップ
  - クイック修正提案

## データ検証

### 1. リアルタイム検証
```typescript
interface ValidationRule {
  field: string;
  type: 'required' | 'format' | 'unique' | 'custom';
  validator: (value: any) => boolean;
  errorMessage: string;
  quickFix?: (value: any) => any;
}

interface ValidationResult {
  isValid: boolean;
  errors: {
    row: number;
    field: string;
    message: string;
    severity: 'error' | 'warning';
    suggestedFix?: any;
  }[];
  warnings: {
    row: number;
    field: string;
    message: string;
    suggestedAction?: string;
  }[];
}
```

### 2. データクリーニング
- 文字列の正規化
- 重複データの検出
- 形式の自動補完
- 特殊文字の処理

## エラーハンドリング

### 1. ファイル処理エラー
- ファイル形式エラー
- サイズ制限超過
- 文字コード問題
- 破損ファイル検出

### 2. データエラー
- 必須項目の欠落
- 形式不正
- 重複データ
- 文字数制限超過

## 最適化機能

### 1. パフォーマンス
- 大容量ファイルの分割処理
- バックグラウンドバリデーション
- プログレッシブローディング
- キャッシュの活用

### 2. ユーザー支援
- エラー修正ガイド
- データクリーニングの提案
- インポート履歴の管理
- テンプレートの提供

## レスポンシブ対応

### デスクトップ
- フルスクリーン活用
- キーボードショートカット
- マルチモニター対応

### タブレット/モバイル
- タッチ操作最適化
- 簡略化されたビュー
- 段階的な処理 